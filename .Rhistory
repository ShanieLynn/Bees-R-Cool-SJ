# NCL Data:
Cover2018 <- rast("~/Documents/Bees-R-Cool-SJ/Data-sets/NLCD/land-cover/2018_NLCD_LndCov_CU_C1V1_mi67k2ad1apaqe.tiff")
library(dplyr)
library(tidyverse)
library(raster)
library(sp)
library(terra)
library(ggplot2)
library(lubridate)
library(glmmTMB)
library(MASS)
library(broom)
library(vegan)
# NCL Data:
Cover2018 <- rast("~/Documents/Bees-R-Cool-SJ/Data-sets/NLCD/land-cover/2018_NLCD_LndCov_CU_C1V1_mi67k2ad1apaqe.tiff")
Cover2024 <- rast("~/Documents/Bees-R-Cool-SJ/Data-sets/NLCD/land-cover/2024_NLCD_LndCov_CU_C1V1_mi67k2ad1apaqe.tiff")
summary(values(Cover2018))
summary(values(Cover2024))
Cover2018.df <- as.data.frame(Cover2018, xy = TRUE)
Cover2024.df <- as.data.frame(Cover2024, xy = TRUE)
levels(Cover2018)
levels(Cover2024)
View(Cover2018.df)
View(Cover2018)
View(Cover2018.df)
install.packages("ijtiff")
library(ijtiff)
# NCL Data:
Cover2018 <- rast("~/Documents/Bees-R-Cool-SJ/Data-sets/NLCD/land-cover/2018_NLCD_LndCov_CU_C1V1_mi67k2ad1apaqe.tiff")
Cover2024 <- rast("~/Documents/Bees-R-Cool-SJ/Data-sets/NLCD/land-cover/2024_NLCD_LndCov_CU_C1V1_mi67k2ad1apaqe.tiff")
summary(values(Cover2018))
summary(values(Cover2024))
tag2018 <- read_tags(Cover2018)
tag2018 <- read_tags(source(Cover2018))
tag2018 <- read_tags(sources(Cover2018))
View(tag2018)
tag2018 <- read_tags(sources(Cover2018))
tag2024 <- read_tags(sources(Cover2024))
Cover2018.df <- as.data.frame(Cover2018, xy = TRUE)
Cover2024.df <- as.data.frame(Cover2024, xy = TRUE)
# OBA Data:
oba <- read.csv("Data-sets/OBA_2018-2024.csv", stringsAsFactors = FALSE)
glimpse(oba)
summary(oba)
# Select columns to keep and drop
oba <- oba %>%
dplyr::select(day, month, year, verbatimElevation, decimalLatitude, decimalLongitude, genus)
## maybe add flower species as well maybe? specific epithet ?
# Remove duplicates
oba <- oba %>%
distinct()
# Remove rows with missing coordinates
oba <- oba %>%
filter(!is.na(decimalLatitude),
!is.na(decimalLongitude))
oba <- oba %>%
filter(verbatimElevation >= -50 & verbatimElevation <= 4000)
oba <- oba %>%
mutate(verbatimElevation = as.numeric(verbatimElevation))
glimpse(oba)
summary(oba)
oba <- oba %>%
mutate(genus = ifelse(is.na(genus) | genus == "" | genus == " ", "Unknown", genus),
genus = str_to_title(genus),
genus = str_replace_all(genus, "[^A-Za-z]", ""))
oba %>%
count(year)
oba %>%
count(genus, sort = TRUE)
oba_vec <- vect(oba, geom = c("decimalLongitude", "decimalLatitude"))
View(oba_vec)
oba_vec <- vect(oba, geom = c("decimalLongitude", "decimalLatitude"))
oba$Cover2018 <- extract(Cover2018, oba_vec)[,2]
oba$Cover2024 <- extract(Cover2024, oba_vec)[,2]
install.packages("RColorBrewer")
install.packages("sf")
# Load libraries
library(dplyr)
library(tidyverse)
library(raster)
library(RColorBrewer)
library(sf)
library(terra)
library(ggplot2)
# NCL Data:
Cover2018_rast <- rast("~/Documents/Bees-R-Cool-SJ/Data-sets/NLCD/land-cover/2018_NLCD_LndCov_CU_C1V1_mi67k2ad1apaqe.tiff")
Cover2024_rast <- rast("~/Documents/Bees-R-Cool-SJ/Data-sets/NLCD/land-cover/2024_NLCD_LndCov_CU_C1V1_mi67k2ad1apaqe.tiff")
summary(values(Cover2018_rast))
summary(values(Cover2024_rast))
# NCL Data:
Cover2018_rast <- rast("~/Documents/Bees-R-Cool-SJ/Data-sets/NLCD/land-cover/2018_NLCD_LndCov_CU_C1V1_mi67k2ad1apaqe.tiff")
Cover2024_rast <- rast("~/Documents/Bees-R-Cool-SJ/Data-sets/NLCD/land-cover/2024_NLCD_LndCov_CU_C1V1_mi67k2ad1apaqe.tiff")
Cover2018_rast
Cover2024_rast
summary(values(Cover2018_rast))
summary(values(Cover2024_rast))
install.packages("xml2")
library(xml2)
library(xml2)
xml <- read_xml("~/Documents/Bees-R-Cool-SJ/Data-sets/NLCD/land-cover/Annual_NLCD_LndCov_2018_CU_C1V1_mi67k2ad1apaqe.tiff.aux.xml")
library(xml2)
xml <- read_xml("~/Documents/Bees-R-Cool-SJ/Data-sets/NLCD/land-cover/Annual_NLCD_LndCov_2018_CU_C1V1_mi67k2ad1apaqe.tiff.aux.xml")
xml
View(xml)
library(xml2)
xml <- read_xml("~/Documents/Bees-R-Cool-SJ/Data-sets/NLCD/land-cover/Annual_NLCD_LndCov_2018_CU_C1V1_mi67k2ad1apaqe.tiff.aux.xml")
xml
xml_children(xml)
mountain_class <- c(41, 42, 43, 52, 71)
mountain_class <- c(41, 42, 43, 52, 71)
Cover2018_mtn <- mask(Cover2018_rast, Cover2018_rast %in% mountain_classes)
plot(Cover2018_rast)
plot(Cover2024_rast)
oba_spvec <- vect(oba, geom = c("decimalLongitute", "decimalLatitude"))
oba <- read.csv("Data-sets/OBA_2018-2024.csv", stringsAsFactors = FALSE)
glimpse(oba)
summary(oba)
# Select columns to keep and drop
oba <- oba %>%
dplyr::select(day, month, year, verbatimElevation, decimalLatitude, decimalLongitude, genus)
## maybe add flower species as well maybe? specific epithet ?
# Remove duplicates
oba <- oba %>%
distinct()
# Remove rows with missing coordinates
oba <- oba %>%
filter(!is.na(decimalLatitude),
!is.na(decimalLongitude))
oba <- oba %>%
filter(verbatimElevation >= -50 & verbatimElevation <= 4000)
oba <- oba %>%
mutate(verbatimElevation = as.numeric(verbatimElevation))
glimpse(oba)
summary(oba)
oba_spvec <- vect(oba, geom = c("decimalLongitute", "decimalLatitude"))
oba_spvec <- vect(oba, geom = c("decimalLongitude", "decimalLatitude"))
oba$lc2018 <- extract(Cover2018_rast, oba_spvec)
oba$lc2024 <- extract(Cover2024_rast, oba_spvec)
View(oba_spvec)
oba_spvec <- vect(oba, geom = c("decimalLongitude", "decimalLatitude"))
oba$lc2018 <- extract(Cover2018_rast, oba_spvec)[,2]
oba$lc2024 <- extract(Cover2024_rast, oba_spvec)[,2]
oba_spvec <- vect(oba, geom = c("decimalLongitude", "decimalLatitude"))
oba$lc2018 <- extract(Cover2018_rast, oba_spvec)
oba$lc2024 <- extract(Cover2024_rast, oba_spvec)
# Select columns to keep and drop
oba <- oba %>%
dplyr::select(day, month, year, verbatimElevation, decimalLatitude, decimalLongitude, genus)
## maybe add flower species as well maybe? specific epithet ?
# Remove duplicates
oba <- oba %>%
distinct()
# Remove rows with missing coordinates
oba <- oba %>%
filter(!is.na(decimalLatitude),
!is.na(decimalLongitude))
oba <- oba %>%
filter(verbatimElevation >= -50 & verbatimElevation <= 6000)
oba <- oba %>%
mutate(verbatimElevation = as.numeric(verbatimElevation))
glimpse(oba)
summary(oba)
oba_spvec <- vect(oba, geom = c("decimalLongitude", "decimalLatitude"))
oba$lc2018 <- extract(Cover2018_rast, oba_spvec)
oba$lc2024 <- extract(Cover2024_rast, oba_spvec)
# NCL Data:
Cover2018_rast <- rast("~/Documents/Bees-R-Cool-SJ/Data-sets/NLCD/land-cover/2018_NLCD_LndCov_CU_C1V1_mi67k2ad1apaqe.tiff")
Cover2024_rast <- rast("~/Documents/Bees-R-Cool-SJ/Data-sets/NLCD/land-cover/2024_NLCD_LndCov_CU_C1V1_mi67k2ad1apaqe.tiff")
Cover2018_rast
Cover2024_rast
summary(values(Cover2018_rast))
summary(values(Cover2024_rast))
plot(Cover2018_rast)
plot(Cover2024_rast)
oba <- read.csv("Data-sets/OBA_2018-2024.csv", stringsAsFactors = FALSE)
glimpse(oba)
summary(oba)
# Select columns to keep and drop
oba <- oba %>%
dplyr::select(day, month, year, verbatimElevation, decimalLatitude, decimalLongitude, genus)
## maybe add flower species as well maybe? specific epithet ?
# Remove duplicates
oba <- oba %>%
distinct()
# Remove rows with missing coordinates
oba <- oba %>%
filter(!is.na(decimalLatitude),
!is.na(decimalLongitude))
oba <- oba %>%
filter(verbatimElevation >= 400 & verbatimElevation <= 6000)
oba <- oba %>%
mutate(verbatimElevation = as.numeric(verbatimElevation))
glimpse(oba)
summary(oba)
oba_2018 <- oba %>%
filter(year == 2018)
oba_2024 <- oba %>%
filter(year == 2024)
View(oba_2018)
View(oba_2024)
oba_spvec <- vect(oba, geom = c("decimalLongitude", "decimalLatitude"))
# extract NLCD classes at each point
oba_2018$lc2018 <- extract(Cover2018_rast, oba_spvec)
# Load libraries
library(dplyr)
library(tidyverse)
library(raster)
library(RColorBrewer)
library(sf)
library(terra)
library(ggplot2)
# NCL Data:
Cover2018_rast <- rast("~/Documents/Bees-R-Cool-SJ/Data-sets/NLCD/land-cover/2018_NLCD_LndCov_CU_C1V1_mi67k2ad1apaqe.tiff")
Cover2024_rast <- rast("~/Documents/Bees-R-Cool-SJ/Data-sets/NLCD/land-cover/2024_NLCD_LndCov_CU_C1V1_mi67k2ad1apaqe.tiff")
Cover2018_rast
Cover2024_rast
summary(values(Cover2018_rast))
summary(values(Cover2024_rast))
plot(Cover2018_rast)
plot(Cover2024_rast)
oba <- read.csv("Data-sets/OBA_2018-2024.csv", stringsAsFactors = FALSE)
glimpse(oba)
summary(oba)
# Select columns to keep and drop
oba <- oba %>%
dplyr::select(day, month, year, verbatimElevation, decimalLatitude, decimalLongitude, genus)
## maybe add flower species as well maybe? specific epithet ?
# Remove duplicates
oba <- oba %>%
distinct()
# Remove rows with missing coordinates
oba <- oba %>%
filter(!is.na(decimalLatitude),
!is.na(decimalLongitude))
oba <- oba %>%
filter(verbatimElevation >= 400 & verbatimElevation <= 6000)
oba <- oba %>%
mutate(verbatimElevation = as.numeric(verbatimElevation))
glimpse(oba)
summary(oba)
eco_3 <- st_read("~/Documents/Bees-R-Cool-SJ/Data-sets/or_eco_l3/or_eco_l3.shp")
eco_3 <- st_read("~/Documents/Bees-R-Cool-SJ/Data-sets/or_eco_l3/or_eco_l3.shp")
oco_4 <- st_read("~/Documents/Bees-R-Cool-SJ/Data-sets/or_eco_l4/or_eco_l4.shp")
eco_3 <- st_read("~/Documents/Bees-R-Cool-SJ/Data-sets/or_eco_l3/or_eco_l3.shp")
eco_4 <- st_read("~/Documents/Bees-R-Cool-SJ/Data-sets/or_eco_l4/or_eco_l4.shp")
print(eco_3)
print(eco_4)
eco_3 <- st_read("~/Documents/Bees-R-Cool-SJ/Data-sets/or_eco_l3/or_eco_l3.shp")
eco_4 <- st_read("~/Documents/Bees-R-Cool-SJ/Data-sets/or_eco_l4/or_eco_l4.shp")
print(eco_3)
cascade <- eco_3 %>%
filter(US_L3NAME %in% c("Coast Range", "Cascades"))
cascade <- eco_3 %>%
filter(US_L3NAME %in% c("Cascades"))
coast <- eco_3 %>%
filter(US_L3NAME %in% c("Coast Range"))
View(cascade)
cascade_rast <- st_transform(cascade, crs(Cover2018_rast))
View(cascade_rast)
View(cascade)
cascade_crop <- crop(Cover2018_rast, cascade_rast)
View(cascade_crop)
cascade_crop <- crop(Cover2018_rast, cascade_rast)
coast_crop <- crop(Cover2018_rast, coast_rast)
# Raster ecoregion and 2018 NLCD
cascade_rast <- st_transform(cascade, crs(Cover2018_rast))
coast_rast <- st_transform(coast, crs(Cover2018_rast))
cascade_crop <- crop(Cover2018_rast, cascade_rast)
coast_crop <- crop(Cover2018_rast, coast_rast)
cascade_mask <- mask(cascade_crop, cascade)
View(cascade_mask)
cascade_rast <- mask(cascade_crop, cascade)
# Load libraries
library(dplyr)
library(tidyverse)
library(raster)
library(RColorBrewer)
library(sf)
library(terra)
library(ggplot2)
# NCL Data:
Cover2018_rast <- rast("~/Documents/Bees-R-Cool-SJ/Data-sets/NLCD/land-cover/2018_NLCD_LndCov_CU_C1V1_mi67k2ad1apaqe.tiff")
Cover2024_rast <- rast("~/Documents/Bees-R-Cool-SJ/Data-sets/NLCD/land-cover/2024_NLCD_LndCov_CU_C1V1_mi67k2ad1apaqe.tiff")
Cover2018_rast
Cover2024_rast
summary(values(Cover2018_rast))
summary(values(Cover2024_rast))
plot(Cover2018_rast)
plot(Cover2024_rast)
oba <- read.csv("Data-sets/OBA_2018-2024.csv", stringsAsFactors = FALSE)
glimpse(oba)
summary(oba)
# Select columns to keep and drop
oba <- oba %>%
dplyr::select(day, month, year, verbatimElevation, decimalLatitude, decimalLongitude, genus)
## maybe add flower species as well maybe? specific epithet ?
# Remove duplicates
oba <- oba %>%
distinct()
# Remove rows with missing coordinates
oba <- oba %>%
filter(!is.na(decimalLatitude),
!is.na(decimalLongitude))
oba <- oba %>%
filter(verbatimElevation >= 400 & verbatimElevation <= 6000)
oba <- oba %>%
mutate(verbatimElevation = as.numeric(verbatimElevation))
glimpse(oba)
summary(oba)
eco_3 <- st_read("~/Documents/Bees-R-Cool-SJ/Data-sets/or_eco_l3/or_eco_l3.shp")
eco_4 <- st_read("~/Documents/Bees-R-Cool-SJ/Data-sets/or_eco_l4/or_eco_l4.shp")
print(eco_3)
cascade <- eco_3 %>%
filter(US_L3NAME %in% c("Cascades"))
coast <- eco_3 %>%
filter(US_L3NAME %in% c("Coast Range"))
# Raster ecoregion and 2018 NLCD
cascade_rast <- st_transform(cascade, crs(Cover2018_rast))
coast_rast <- st_transform(coast, crs(Cover2018_rast))
cascade_crop <- crop(Cover2018_rast, cascade_rast)
coast_crop <- crop(Cover2018_rast, coast_rast)
cascade_rast <- mask(cascade_crop, cascade)
cascade_mask <- mask(cascade_rast, cascade)
# Raster ecoregion and 2018 NLCD
cascade_rast <- st_transform(cascade, crs(Cover2018_rast))
coast_rast <- st_transform(coast, crs(Cover2018_rast))
cascade_crop <- crop(Cover2018_rast, cascade_rast)
coast_crop <- crop(Cover2018_rast, coast_rast)
cascade_mask <- mask(cascade_rast, cascade)
cascade_mask <- mask(cascade_crop, cascade_rast)
# Load libraries
library(dplyr)
library(tidyverse)
library(raster)
library(RColorBrewer)
library(sf)
library(terra)
library(ggplot2)
# NCL Data:
Cover2018_rast <- rast("~/Documents/Bees-R-Cool-SJ/Data-sets/NLCD/land-cover/2018_NLCD_LndCov_CU_C1V1_mi67k2ad1apaqe.tiff")
Cover2024_rast <- rast("~/Documents/Bees-R-Cool-SJ/Data-sets/NLCD/land-cover/2024_NLCD_LndCov_CU_C1V1_mi67k2ad1apaqe.tiff")
Cover2018_rast
Cover2024_rast
summary(values(Cover2018_rast))
summary(values(Cover2024_rast))
plot(Cover2018_rast)
plot(Cover2024_rast)
oba <- read.csv("Data-sets/OBA_2018-2024.csv", stringsAsFactors = FALSE)
glimpse(oba)
summary(oba)
# Select columns to keep and drop
oba <- oba %>%
dplyr::select(day, month, year, verbatimElevation, decimalLatitude, decimalLongitude, genus)
## maybe add flower species as well maybe? specific epithet ?
# Remove duplicates
oba <- oba %>%
distinct()
# Remove rows with missing coordinates
oba <- oba %>%
filter(!is.na(decimalLatitude),
!is.na(decimalLongitude))
oba <- oba %>%
filter(verbatimElevation >= 400 & verbatimElevation <= 6000)
oba <- oba %>%
mutate(verbatimElevation = as.numeric(verbatimElevation))
glimpse(oba)
summary(oba)
eco_3 <- st_read("~/Documents/Bees-R-Cool-SJ/Data-sets/or_eco_l3/or_eco_l3.shp")
eco_4 <- st_read("~/Documents/Bees-R-Cool-SJ/Data-sets/or_eco_l4/or_eco_l4.shp")
print(eco_3)
cascade <- eco_3 %>%
filter(US_L3NAME %in% c("Cascades"))
coast <- eco_3 %>%
filter(US_L3NAME %in% c("Coast Range"))
# Raster ecoregion and 2018 NLCD
cascade_rast18 <- st_transform(cascade, crs(Cover2018_rast))
coast_rast18 <- st_transform(coast, crs(Cover2018_rast))
cascade_crop18 <- crop(Cover2018_rast, cascade_rast18)
coast_crop18 <- crop(Cover2018_rast, coast_rast18)
cascade_mask18 <- mask(cascade_crop18, cascade_rast18)
coast_mask18 <- mask(coast_crop18, coast_rast18)
cascade_df18 <- as.data.frame(cascade_mask18, xy = TRUE, na.rm = TRUE)
coast_df18 <- as.data.frame(coast_mask18, xy = TRUE, na.rm = TRUE)
oba_2018 <- oba %>%
filter(year == 2018)
oba_2024 <- oba %>%
filter(year == 2024)
# Add a column for land-cover values
cascade_df18 <- cascade_df18 %>%
rename(landcover = names(cascade_mask18))
coast_df18 <- coast_df18 %>%
rename(landcover = names(coast_mask18))
# Add a column for land-cover values
cascade_df18 <- cascade_df18 %>%
rename(landcover = names(cascade_mask18))
cascade_df18 <- as.data.frame(cascade_mask18, xy = TRUE, na.rm = TRUE)
coast_df18 <- as.data.frame(coast_mask18, xy = TRUE, na.rm = TRUE)
names(cascade_df18)
names(coast_df18)
# Add a column for land-cover values
cascade_df18 <- cascade_df18 %>%
rename(landcover = `2018_NLCD_LndCov_CU_C1V1_mi67k2ad1apaqe`)
coast_df18 <- coast_df18 %>%
rename(landcover = `2018_NLCD_LndCov_CU_C1V1_mi67k2ad1apaqe`)
# convert OBA points to sf (move up to oba data)
oba_sf <- st_as_sf(
oba,
coords = c("decimalLongitude", "decimalLatitude"),
crs = 4326
)
# Transform to raster CRS
oba_sf <- st_transform(oba_sf, crs(Cover2018_rast))
ggplot() +
geom_raster(data = cascade_df18,
aes(x = x, y = y, fill = Cover2018_rast)) +
geom_sf(data = cascade, fill = NA, color = "midnightblue") +
geom_sf(data = oba_sf2018,
aes(color = genus), size = 1, alpha = 0.7) +
scale_fill_brewer(palette = "Spectral", direction = -1) +
coord_equal() +
ggtitle("2018 Cascades")
# Add a column for land-cover values
cascade_df18 <- cascade_df18 %>%
rename(landcover = `2018_NLCD_LndCov_CU_C1V1_mi67k2ad1apaqe`)
# Add a column for land-cover values
cascade_df18 <- cascade_df18 %>%
rename(landcover = names(2018_NLCD_LndCov_CU_C1V1_mi67k2ad1apaqe))
cascade_df18 <- as.data.frame(cascade_mask18, xy = TRUE, na.rm = TRUE) %>%
rename(landcover = 3)
coast_df18 <- as.data.frame(coast_mask18, xy = TRUE, na.rm = TRUE) %>%
rename(landcover = 3)
names(cascade_df18)
names(coast_df18)
oba_2018 <- oba %>%
filter(year == 2018)
oba_2024 <- oba %>%
filter(year == 2024)
# convert OBA points to sf (move up to oba data)
oba_sf2018 <- st_as_sf(
oba_2018,
coords = c("decimalLongitude", "decimalLatitude"),
crs = 4326
)
# Transform to raster CRS
oba_sf2018 <- st_transform(oba_sf_2018, crs(Cover2018_rast))
# convert OBA points to sf (move up to oba data)
oba_sf2018 <- st_as_sf(
oba_2018,
coords = c("decimalLongitude", "decimalLatitude"),
crs = 4326
)
# Transform to raster CRS
oba_sf2018 <- st_transform(oba_sf2018, crs(Cover2018_rast))
ggplot() +
geom_raster(data = cascade_df18,
aes(x = x, y = y, fill = landcover)) +
geom_sf(data = oba_sf2018, color = "black", size = 1, alpha = 0.7) +
scale_fill_brewer(palette = "Spectral", direction = -1) +
coord_sf() +
ggtitle("2018 Cascades Bee Data")
cascade_df18$landcover <- as.factor(cascade_df18$landcover)
ggplot() +
geom_raster(data = cascade_df18,
aes(x = x, y = y, fill = landcover)) +
geom_sf(data = oba_sf2018, color = "black", size = 1, alpha = 0.7) +
scale_fill_brewer(palette = "Spectral", direction = -1) +
coord_sf() +
ggtitle("2018 Cascades Bee Data")
